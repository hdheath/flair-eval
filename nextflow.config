// Nextflow configuration for FLAIR evaluation pipeline

// Global parameters
params {
    // Input samplesheet (CSV) with dataset definitions
    input = null
    // Parameters configuration file (JSON) with align/partition/transcriptome mode parameters
    params_file = null
    // Test name for output organization
    test_name = 'flair_test_suite'

    // Optional files for partition process
    cage_peaks = null
    quantseq_peaks = null
    junctions = null
    target_regions = null
}

// Process defaults - apply to all processes
process {
    executor = 'slurm'
    clusterOptions = '--partition=short'
    time = '1h'
    memory = '32 GB'
    conda = '/private/home/hdheath/miniforge3/envs/flair-dev'
    stageInMode = 'symlink'  // Use symlinks instead of copies for input files

    // Process-specific resource overrides
    withName: 'FlairAlign' {
        cpus = 8
        memory = '64 GB'
        time = '24h'
        clusterOptions = '--partition=long'
    }

    withName: 'FlairTranscriptome' {
        cpus = 4
        memory = '32 GB'
        time = '12h'
        clusterOptions = '--partition=medium'
    }

    withName: 'FlairEvaluation' {
        cpus = 2
        memory = '16 GB'
        time = '4h'
        clusterOptions = '--partition=medium'
    }
}

// Enable conda
conda {
    enabled = true
}

// =============================================================================
// EXECUTION REPORTS - Automatically generate detailed logs and reports
// =============================================================================

// Trace report: detailed info about each task execution
trace {
    enabled = true
    file = 'results/reports/execution_trace.txt'
    fields = 'task_id,hash,native_id,process,tag,name,status,exit,submit,start,complete,duration,realtime,workdir'
    overwrite = true
}

// HTML report: visual summary of pipeline execution
report {
    enabled = true
    file = 'results/reports/execution_report.html'
    overwrite = true
}

// Timeline: visual timeline of task execution
timeline {
    enabled = true
    file = 'results/reports/execution_timeline.html'
    overwrite = true
}
